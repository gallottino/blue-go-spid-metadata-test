<?xml version="1.0" encoding="UTF-8"?>
<md:EntityDescriptor
    xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns:spid="https://spid.gov.it/saml-extensions"
    entityID="https://sp.myservice.it"
    ID="_[UNIQUE_ENTITY_ID_STRING_REQUIRED]"
    validUntil="[YYYY-MM-DDTHH:MM:SSZ]">

    <ds:Signature>
        <ds:SignedInfo>
            <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-c14n#"/>
            <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
            <ds:Reference URI="#_[UNIQUE_ENTITY_ID_STRING_REQUIRED]">
                <ds:Transforms>
                    <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                    <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-c14n#"/>
                </ds:Transforms>
                <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
                <ds:DigestValue>[DIGEST_VALUE]</ds:DigestValue>
            </ds:Reference>
        </ds:SignedInfo>
        <ds:SignatureValue>[SIGNATURE_VALUE]</ds:SignatureValue>
        <ds:KeyInfo>
            <ds:X509Data>
                <ds:X509Certificate>
                    [BASE64_ENCODED_X509_CERTIFICATE]
                </ds:X509Certificate>
            </ds:X509Data>
        </ds:KeyInfo>
    </ds:Signature>

    <md:Extensions>
        <spid:Private/>
    </md:Extensions>

    <md:SPSSODescriptor
        AuthnRequestsSigned="true"
        WantAssertionsSigned="true"
        protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol">

        <md:KeyDescriptor use="signing">
            <ds:KeyInfo>
                <ds:X509Data>
                    <ds:X509Certificate>
                        [BASE64_ENCODED_X509_CERTIFICATE]
                    </ds:X509Certificate>
                </ds:X509Data>
            </ds:KeyInfo>
        </md:KeyDescriptor>
        
        <md:NameIDFormat>
            urn:oasis:names:tc:SAML:2.0:nameid-format:transient
        </md:NameIDFormat>

        <md:AssertionConsumerService
            Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
            Location="https://sp.myservice.it/saml/acs"
            index="0"
            isDefault="true"/>
        
        <md:SingleLogoutService
            Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"
            Location="https://sp.myservice.it/saml/slo"/>

        <md:AttributeConsumingService index="0">
            <md:ServiceName xml:lang="it">My Service SPID Login</md:ServiceName>
            <md:ServiceDescription xml:lang="it">Accesso ai servizi online della mia azienda tramite SPID.</md:ServiceDescription>
            
            <md:RequestedAttribute isRequired="true" Name="spidCode" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"/>
            <md:RequestedAttribute isRequired="true" Name="name" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"/>
            <md:RequestedAttribute isRequired="true" Name="familyName" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"/>
            <md:RequestedAttribute isRequired="true" Name="fiscalNumber" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"/>
            <md:RequestedAttribute isRequired="false" Name="email" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"/>
            </md:AttributeConsumingService>
    </md:SPSSODescriptor>

    <md:Organization>
        <md:OrganizationName xml:lang="it">AZIENDA ESEMPIO S.R.L.</md:OrganizationName>
        <md:OrganizationDisplayName xml:lang="it">Azienda Esempio</md:OrganizationDisplayName>
        <md:OrganizationURL xml:lang="it">https://www.myservice.it</md:OrganizationURL>
    </md:Organization>

    <md:ContactPerson contactType="other">
        <md:GivenName>Technical</md:GivenName>
        <md:EmailAddress>mailto:spid-tech@myservice.it</md:EmailAddress>
        <md:TelephoneNumber>+39 012 3456789</md:TelephoneNumber>
    </md:ContactPerson>

    <md:ContactPerson contactType="billing">
        <md:Extensions>
            <spid:VATNumber>IT12345678901</spid:VATNumber> <spid:FiscalCode>ABCXYZAA11B222C</spid:FiscalCode> </md:Extensions>
        <md:GivenName>Billing</md:GivenName>
        <md:EmailAddress>mailto:billing@myservice.it</md:EmailAddress>
    </md:ContactPerson>

</md:EntityDescriptor>
